---
dependency:
  name: 'shell'
  command: bash ${MOLECULE_PROJECT_DIRECTORY}/molecule/default/docker-network.sh
driver:
  name: 'docker'
lint:
  name: 'yamllint'
  options:
    config-file: 'molecule/default/yamllint.yml'
platforms:
  - name: "acme-ssl-client"
    image: "geerlingguy/docker-${MOLECULE_DISTRO:-debian9}-ansible:latest"
    command: '/lib/systemd/systemd'
    pre_build_image: true
    volumes:
      - '/sys/fs/cgroup:/sys/fs/cgroup:ro'
    privileged: true
    networks:
      - name: "acmenet"
        ipv4_address: '10.30.50.4'
  - name: "acme-ssl-helper"
    image: "geerlingguy/docker-debian9-ansible:latest"
    command: '/lib/systemd/systemd'
    pre_build_image: true
    volumes:
      - '/sys/fs/cgroup:/sys/fs/cgroup:ro'
    privileged: true
    networks:
      - name: "acmenet"
        ipv4_address: '10.30.50.3'
  - name: 'pebble'
    image: 'letsencrypt/pebble'
    command: 'pebble --dnsserver 10.30.50.3:53'
    pre_build_image: true
    networks:
      - name: "acmenet"
        ipv4_address: '10.30.50.2'
provisioner:
  name: 'ansible'
  lint:
    name: 'ansible-lint'
verifier:
  name: 'testinfra'
  lint:
    name: 'flake8'
